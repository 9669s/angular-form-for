angular.module("formFor",[]);var formFor;!function(e){var t=function(){function e(){this.restrict="A"}return e.prototype.link=function(e,t,i){e.$watch("model.uid",function(e){i.$set("ariaDescribedby",e+"-error"),i.$set("ariaLabelledby",e+"-label")}),e.$watch("model.error",function(e){i.$set("ariaInvalid",!!e)})},e}();e.AriaManager=t,angular.module("formFor").directive("ariaManager",function(){return new t})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(){this.autoGenerateLabels_=!1,this.defaultDebounceDuration_=500,this.defaultSubmitComplete_=angular.noop,this.defaultSubmitError_=angular.noop,this.defaultValidationFailed_=angular.noop,this.requiredLabel_=null,this.validationFailedForCustomMessage_="Failed custom validation",this.validationFailedForEmailTypeMessage_="Invalid email format",this.validationFailedForIntegerTypeMessage_="Must be an integer",this.validationFailedForMaxCollectionSizeMessage_="Must be fewer than {{num}} items",this.validationFailedForMaxLengthMessage_="Must be fewer than {{num}} characters",this.validationFailedForMinCollectionSizeMessage_="Must at least {{num}} items",this.validationFailedForMinLengthMessage_="Must be at least {{num}} characters",this.validationFailedForNegativeTypeMessage_="Must be negative",this.validationFailedForNonNegativeTypeMessage_="Must be non-negative",this.validationFailedForNumericTypeMessage_="Must be numeric",this.validationFailedForPatternMessage_="Invalid format",this.validationFailedForPositiveTypeMessage_="Must be positive",this.validationFailedForRequiredMessage_="Required field"}return Object.defineProperty(t.prototype,"autoGenerateLabels",{get:function(){return this.autoGenerateLabels_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultDebounceDuration",{get:function(){return this.defaultDebounceDuration_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultSubmitComplete",{get:function(){return this.defaultSubmitComplete_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultSubmitError",{get:function(){return this.defaultSubmitError_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultValidationFailed",{get:function(){return this.defaultValidationFailed_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requiredLabel",{get:function(){return this.requiredLabel_},enumerable:!0,configurable:!0}),t.prototype.disableAutoLabels=function(){this.autoGenerateLabels_=!1},t.prototype.enableAutoLabels=function(){this.autoGenerateLabels_=!0},t.prototype.getFailedValidationMessage=function(t){switch(t){case e.ValidationFailureType.CUSTOM:return this.validationFailedForCustomMessage_;case e.ValidationFailureType.COLLECTION_MAX_SIZE:return this.validationFailedForMaxCollectionSizeMessage_;case e.ValidationFailureType.COLLECTION_MIN_SIZE:return this.validationFailedForMinCollectionSizeMessage_;case e.ValidationFailureType.MAX_LENGTH:return this.validationFailedForMaxLengthMessage_;case e.ValidationFailureType.MIN_LENGTH:return this.validationFailedForMinLengthMessage_;case e.ValidationFailureType.PATTERN:return this.validationFailedForPatternMessage_;case e.ValidationFailureType.REQUIRED:return this.validationFailedForRequiredMessage_;case e.ValidationFailureType.TYPE_EMAIL:return this.validationFailedForEmailTypeMessage_;case e.ValidationFailureType.TYPE_INTEGER:return this.validationFailedForIntegerTypeMessage_;case e.ValidationFailureType.TYPE_NEGATIVE:return this.validationFailedForNegativeTypeMessage_;case e.ValidationFailureType.TYPE_NON_NEGATIVE:return this.validationFailedForNonNegativeTypeMessage_;case e.ValidationFailureType.TYPE_NUMERIC:return this.validationFailedForNumericTypeMessage_;case e.ValidationFailureType.TYPE_POSITIVE:return this.validationFailedForPositiveTypeMessage_}},t.prototype.setDefaultDebounceDuration=function(e){this.defaultDebounceDuration_=e},t.prototype.setDefaultSubmitComplete=function(e){this.defaultSubmitComplete_=e},t.prototype.setDefaultSubmitError=function(e){this.defaultSubmitError_=e},t.prototype.setDefaultValidationFailed=function(e){this.defaultValidationFailed_=e},t.prototype.setRequiredLabel=function(e){this.requiredLabel_=e},t.prototype.setValidationFailedForCustomMessage=function(e){this.validationFailedForCustomMessage_=e},t.prototype.setValidationFailedForMaxCollectionSizeMessage=function(e){this.validationFailedForMaxCollectionSizeMessage_=e},t.prototype.setValidationFailedForMaxLengthMessage=function(e){this.validationFailedForMaxLengthMessage_=e},t.prototype.setValidationFailedForMinCollectionSizeMessage=function(e){this.validationFailedForMaxCollectionSizeMessage_=e},t.prototype.setValidationFailedForMinLengthMessage=function(e){this.validationFailedForMinLengthMessage_=e},t.prototype.setValidationFailedForPatternMessage=function(e){this.validationFailedForPatternMessage_=e},t.prototype.setValidationFailedForRequiredMessage=function(e){this.validationFailedForRequiredMessage_=e},t.prototype.setValidationFailedForEmailTypeMessage=function(e){this.validationFailedForEmailTypeMessage_=e},t.prototype.setValidationFailedForIntegerTypeMessage=function(e){this.validationFailedForIntegerTypeMessage_=e},t.prototype.setValidationFailedForNegativeTypeMessage=function(e){this.validationFailedForNegativeTypeMessage_=e},t.prototype.setValidationFailedForNonNegativeTypeMessage=function(e){this.validationFailedForNonNegativeTypeMessage_=e},t.prototype.setValidationFailedForNumericTypeMessage=function(e){this.validationFailedForNumericTypeMessage_=e},t.prototype.setValidationFailedForPositiveTypeMessage=function(e){this.validationFailedForPositiveTypeMessage_=e},t}();e.FormForConfiguration=t,angular.module("formFor").service("FormForConfiguration",function(){return new t})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t,i){this.require="^formFor",this.restrict="EA",this.templateUrl="form-for/templates/checkbox-field.html",this.scope={attribute:"@",disable:"=",help:"@?",changed:"@?"},this.$log_=t,this.fieldHelper_=new e.FieldHelper(i)}return t.prototype.link=function(e,t,i,r){return e.attribute?(e.tabIndex=i.tabIndex||0,e.toggle=function(){e.disable||e.model.disabled||(e.model.bindable=!e.model.bindable)},this.fieldHelper_.manageLabel(e,i,!1),void this.fieldHelper_.manageFieldRegistration(e,i,r)):void this.$log_.error('Missing required field "attribute"')},t}();e.CheckboxField=t,angular.module("formFor").directive("checkboxField",function(e,i){return new t(e,i)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e){this.require="^formFor",this.restrict="EA",this.templateUrl="form-for/templates/collection-label.html",this.scope={attribute:"@",help:"@?",label:"@"},this.$sce_=e}return e.prototype.link=function(e,t,i,r){e.$watch("label",function(t){e.bindableLabel=this.$sce_.trustAsHtml(t)}),e.model=r.registerCollectionLabel(e.attribute)},e}();e.CollectionLabel=t,angular.module("formFor").directive("collectionLabel",function(e){return new t(e)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(){this.restrict="EA",this.templateUrl="form-for/templates/field-error.html",this.scope={error:"=",leftAligned:"@?",uid:"@"}}return e}();e.FieldError=t,angular.module("formFor").directive("fieldError",function(){return new t})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e,t){this.replace=!0,this.restrict="EA",this.templateUrl="form-for/templates/field-label.html",this.scope={inputUid:"@",help:"@?",label:"@",required:"@?",uid:"@"},this.$sce_=e,this.formForConfiguration_=t}return e.prototype.controller=function(e){e.$watch("label",function(t){e.bindableLabel=this.$sce_.trustAsHtml(t)}),e.$watch("required",function(t){e.requiredLabel=e.$eval(t)?this.formForConfiguration_.requiredLabel:null})},e}();e.FieldLabel=t,angular.module("formFor").directive("fieldLabel",function(e,i){return new t(e,i)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e,t,i,r){this.priority=99,this.require="ngModel",this.restrict="A",this.scope={formForDebounce:"@"},this.$log_=e,this.$sniffer_=t,this.$timeout_=i,this.formForConfiguration_=r}return e.prototype.link=function(e,t,i,r){var o=this;if("radio"===i.type||"checkbox"===i.type)return void this.$log_.warn("formForDebounce should only be used with <input type=text> and <textarea> elements");var n=i.formForDebounce,a=this.formForConfiguration_.defaultDebounceDuration;void 0!==n&&("false"===n.toString()?a=!1:(n=parseInt(n),angular.isNumber(n)&&!isNaN(n)&&(a=n))),this.$sniffer_.hasEvent("input")?t.off("input"):(t.off("keydown"),this.$sniffer_.hasEvent("paste")&&t.off("paste"));var l;if(a!==!1){var s=function(){o.$timeout_.cancel(l),l=o.$timeout_(function(){e.$apply(function(){r.$setViewValue(t.val())})},a)};this.$sniffer_.hasEvent("input")?t.on("input",void 0,s):(t.on("keydown",void 0,s),this.$sniffer_.hasEvent("paste")&&t.on("paste",void 0,s))}t.on("blur",void 0,function(){e.$apply(function(){r.$setViewValue(t.val())})}),e.$on("$destroy",function(){l&&o.$timeout_.cancel(l)})},e}();e.FormForDebounce=t,angular.module("formFor").directive("formForDebounce",function(e,i,r,o){return new t(e,i,r,o)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e){this.$parse_=e}return e.prototype.flattenAttribute=function(e){return e.replace(/\[([^\]]+)\]\.{0,1}/g,"___$1___").replace(/\./g,"___")},e.prototype.flattenObjectKeys=function(e){for(var t=[],i=[{object:e,prefix:null}];;){if(0===i.length)break;var r=i.pop(),o=r.prefix?r.prefix+".":"";if("object"==typeof r.object)for(var n in r.object){var a=o+n,l=r.object[n];t.push(a),i.push({object:l,prefix:a})}}return t},e.prototype.readAttribute=function(e,t){return this.$parse_(t)(e)},e.prototype.writeAttribute=function(e,t,i){this.initializeArraysAndObjectsForParse_(e,t),this.$parse_(t).assign(e,i)},e.prototype.initializeArraysAndObjectsForParse_=function(e,t){for(var i=0;;){if(i=t.indexOf("[",i),0>i)break;var r=t.substr(0,i),o=this.readAttribute(e,r);o||(o=[],this.writeAttribute(e,r,o));var n=t.substr(i).match(/([0-9]+)\]\./);if(n){var a=parseInt(n[1]);o[a]||(o[a]={})}i++}},e}();e.NestedObjectHelper=t}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e){this.$q_=e}return e.prototype.all=function(e){return this.$q_.all(e)},e.prototype.defer=function(){return this.$q_.defer()},e.prototype.resolve=function(e){var t=this.$q_.defer();return t.resolve(e),t.promise},e.prototype.reject=function(e){return this.$q_.reject(e)},e.prototype.waitForAll=function(e){function t(e,t){o.hasOwnProperty(e)||(o[e]=t,n--),i()}function i(){0===n&&(a?r.reject(o):r.resolve(o))}var r=this.$q_.defer(),o={},n=0,a=!1;return angular.forEach(e,function(e,i){n++,e.then(function(e){t(i,e)},function(e){a=!0,t(i,e)})}),i(),r.promise},e.prototype.when=function(e){return this.$q_.when(e)},e}();e.PromiseUtils=t}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t,i,r,o){this.$parse_=t,this.$scope_=r,this.modelValidator_=o,this.nestedObjectHelper_=new e.NestedObjectHelper(t),this.promiseUtils_=new e.PromiseUtils(i)}return t.prototype.registerCollectionLabel=function(e){var t=this,i=this.nestedObjectHelper_.flattenAttribute(e),r={error:null,required:this.modelValidator_.isCollectionRequired(e,this.$scope_.$validationRuleset)};this.$scope_.collectionLabels[i]=r;var o=!1;return this.$scope_.$watch("formFor."+e+".length",function(){o?t.$scope_.validateOn&&"change"!==t.$scope_.validateOn||t.modelValidator_.validateCollection(t.$scope_.formFor,e,t.$scope_.$validationRuleset).then(function(){t.$scope_.formForStateHelper.setFieldError(i,null)},function(e){t.$scope_.formForStateHelper.setFieldError(i,e)}):o=!0}),r},t.prototype.registerFormField=function(t){var i=this;if(!t)throw Error('Invalid field name "'+t+'" provided.');var r=this.nestedObjectHelper_.flattenAttribute(t);if(this.$scope_.fields.hasOwnProperty(r))throw Error('Field "'+t+'" has already been registered. Field names must be unique.');var o={bindable:null,disabled:this.$scope_.disable,error:null,pristine:!0,required:this.modelValidator_.isFieldRequired(t,this.$scope_.$validationRuleset),uid:e.FormForGUID.create()},n={bindableWrapper:o,fieldName:t,formForStateHelper:this.$scope_.formForStateHelper,unwatchers:[]};this.$scope_.fields[r]=n;var a=this.$parse_(t);n.unwatchers.push(this.$scope_.$watch("fields."+r+".bindableWrapper.bindable",function(e,t){e!==t&&a.assign(i.$scope_.formFor,e)}));var l;return n.unwatchers.push(this.$scope_.$watch("formFor."+t,function(e,o){(e!==n.bindableWrapper.bindable||void 0===o&&""===e||void 0===e)&&(l=!1),n.bindableWrapper.bindable=e,i.$scope_.validateOn&&"change"!==i.$scope_.validateOn||i.validateField(t),l||(l=!0,i.$scope_.formForStateHelper.setFieldHasBeenModified(r,!1)),n.bindableWrapper.pristine=!i.$scope_.formForStateHelper.hasFieldBeenModified(r)})),o},t.prototype.registerSubmitButton=function(){var e={disabled:!1};return this.$scope_.buttons.push(e),e},t.prototype.resetErrors=function(){for(var e in this.$scope_.fields)this.$scope_.formForStateHelper.getFieldError(e)&&(this.$scope_.formForStateHelper.setFieldHasBeenModified(e,!1),this.$scope_.fields[e].bindableWrapper.pristine=!0);this.$scope_.formForStateHelper.setFormSubmitted(!1),this.$scope_.formForStateHelper.resetFieldErrors()},t.prototype.resetField=function(e){var t=this.nestedObjectHelper_.flattenAttribute(e);this.$scope_.formForStateHelper.getFieldError(t)&&(this.$scope_.formForStateHelper.setFieldHasBeenModified(t,!1),this.$scope_.fields[t].bindableWrapper.pristine=!0),this.$scope_.formForStateHelper.setFieldError(t,null)},t.prototype.resetFields=function(){this.resetErrors()},t.prototype.setFieldError=function(e,t){var i=this.nestedObjectHelper_.flattenAttribute(e);this.$scope_.formForStateHelper.setFieldHasBeenModified(i,!0),this.$scope_.formForStateHelper.setFieldError(i,t)},t.prototype.unregisterFormField=function(e){var t=this.nestedObjectHelper_.flattenAttribute(e);angular.forEach(this.$scope_.fields[t].unwatchers,function(e){e()}),delete this.$scope_.fields[t]},t.prototype.updateCollectionErrors=function(e){var t=this;angular.forEach(this.$scope_.collectionLabels,function(i,r){var o=t.nestedObjectHelper_.readAttribute(e,r);t.$scope_.formForStateHelper.setFieldError(r,o)})},t.prototype.updateFieldErrors=function(e){var t=this;angular.forEach(this.$scope_.fields,function(i,r){var o=t.nestedObjectHelper_.readAttribute(e,i.fieldName);t.$scope_.formForStateHelper.setFieldError(r,o)})},t.prototype.validateField=function(e){var t=this,i=this.nestedObjectHelper_.flattenAttribute(e);this.$scope_.formForStateHelper.setFieldHasBeenModified(i,!0),this.$scope_.$validationRuleset&&this.modelValidator_.validateField(this.$scope_.formFor,e,this.$scope_.$validationRuleset).then(function(){t.$scope_.formForStateHelper.setFieldError(i,null)},function(e){t.$scope_.formForStateHelper.setFieldError(i,e)})},t.prototype.validateForm=function(e){var t=this;this.updateCollectionErrors({}),this.updateFieldErrors({});var i,r;if(this.$scope_.$validationRuleset){var o=[];angular.forEach(this.$scope_.fields,function(e){o.push(e.fieldName)}),r=this.modelValidator_.validateFields(this.$scope_.formFor,o,this.$scope_.$validationRuleset),r.then(angular.noop,this.updateFieldErrors),o=[],angular.forEach(this.$scope_.collectionLabels,function(e,t){o.push(t)}),i=this.modelValidator_.validateFields(this.$scope_.formFor,o,this.$scope_.$validationRuleset),i.then(angular.noop,this.updateCollectionErrors)}else i=this.promiseUtils_.resolve(),r=this.promiseUtils_.resolve();var n=this.promiseUtils_.defer();return this.promiseUtils_.waitForAll([i,r]).then(n.resolve,function(i){angular.isArray(i[0])&&0===i[0].length&&i.splice(0,1),e&&angular.forEach(i,function(e){var i=t.nestedObjectHelper_.flattenObjectKeys(e);angular.forEach(i,function(i){var r=t.nestedObjectHelper_.readAttribute(e,i);if(r){var o=t.nestedObjectHelper_.flattenAttribute(i);t.$scope_.formForStateHelper.setFieldHasBeenModified(o,!0)}})}),n.reject(i)}),n.promise},t}();e.FormForController=t}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t){this.require="form",this.restrict="A",this.scope={controller:"=?",disable:"=?",formFor:"=",service:"@",submitComplete:"&?",submitError:"&?",submitWith:"&?",valid:"=?",validateOn:"=?",validationFailed:"&?",validationRules:"=?"},this.$injector_=t,this.$log_=t.get("$log"),this.$parse_=t.get("$parse"),this.$sce_=t.get("$sce"),this.formForConfiguration_=t.get("FormForConfiguration"),this.modelValidator_=t.get("ModelValidator");var i=t.get("$q");this.nestedObjectHelper_=new e.NestedObjectHelper(this.$parse_),this.promiseUtils_=new e.PromiseUtils(i)}return t.prototype.controller=function(t){var i=this;t.formFor||this.$log_.error('The form data object specified by <form form-for=""> is null or undefined.'),t.fields={},t.collectionLabels={},t.buttons=[],t.service&&(t.$service=this.$injector_.get(t.service)),t.validationRules?t.$validationRuleset=t.validationRules:t.$service&&(t.$validationRuleset=t.$service.validationRules);var r=new e.FormForController(this.$parse_,this.promiseUtils_,t,this.modelValidator_);t.controller?angular.copy(r,t.controller):t.controller=r,t.$watch("disable",function(e){angular.forEach(t.fields,function(t){t.bindableWrapper.disabled=e}),angular.forEach(t.buttons,function(t){t.disabled=e})}),t.formForStateHelper=new e.FormForStateHelper(this.$parse_,t),t.$watch("formForStateHelper.watchable",function(){var e=t.formForStateHelper.hasFormBeenSubmitted();angular.forEach(t.fields,function(r,o){if(e||t.formForStateHelper.hasFieldBeenModified(o)){var n=t.formForStateHelper.getFieldError(o);r.bindableWrapper.error=n?i.$sce_.trustAsHtml(n):null}else r.bindableWrapper.error=null}),angular.forEach(t.collectionLabels,function(e,r){var o=t.formForStateHelper.getFieldError(r);e.error=o?i.$sce_.trustAsHtml(o):null})})},t.prototype.link=function(e,t,i){var r=this;t.on("submit",void 0,function(){e.formForStateHelper.setFormSubmitted(!0),e.disable=!0;var t;return t="manual"===e.validateOn?r.promiseUtils_.resolve():e.controller.validateForm(),t.then(function(){var t;t=i.submitWith?e.submitWith({data:e.formFor}):e.$service&&e.$service.submit?e.$service.submit(e.formFor):r.promiseUtils_.reject("No submit function provided"),t||(t=r.promiseUtils_.reject("Submit function did not return a promise")),t.then(function(t){i.submitComplete?e.submitComplete({data:t}):r.formForConfiguration_.defaultSubmitComplete(t)},function(t){angular.isObject(t)&&"manual"!==e.validateOn&&(e.controller.updateCollectionErrors(t),e.controller.updateFieldErrors(t)),i.submitError?e.submitError({error:t}):r.formForConfiguration_.defaultSubmitError(t)}),t["finally"](function(){e.disable=!1})},function(t){e.disable=!1,i.validationFailed?e.validationFailed():r.formForConfiguration_.defaultValidationFailed(t)}),!1})},t}();e.FormFor=t,angular.module("formFor").directive("formFor",function(e){return new t(e)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(){}return e.create=function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)},e}();e.FormForGUID=t}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t,i){this.require="^formFor",this.restrict="EA",this.templateUrl="form-for/templates/radio-field.html",this.scope={attribute:"@",disable:"=",help:"@?",value:"@"},this.$log_=t,this.fieldHelper_=new e.FieldHelper(i),this.fieldNameToActiveRadioGroupDatumMap_={}}return t.prototype.link=function(t,i,r,o){if(!t.attribute)return void this.$log_.error('Missing required field "attribute"');this.fieldNameToActiveRadioGroupDatumMap_[t.attribute]?t.hideErrorMessage=!0:(this.fieldHelper_.manageFieldRegistration(t,r,o),this.fieldNameToActiveRadioGroupDatumMap_[t.attribute]={defaultScope:t,scopes:[]}),t.uid=r.uid||e.FormForGUID.create();var n=this.fieldNameToActiveRadioGroupDatumMap_[t.attribute];n.scopes.push(t),this.fieldHelper_.manageLabel(t,r,!0),t.tabIndex=r.tabIndex||0,t.click=function(){t.disable||t.model.disabled||(t.model.bindable=t.value)},n.defaultScope.$watch("model",function(e){t.model=e}),n.defaultScope.$watch("disable",function(e){t.disable=e}),n.defaultScope.$watch("model.disabled",function(e){t.model&&(t.model.disabled=e)}),t.$watch("model.bindable",function(e){t.checked=void 0!==e&&null!==e&&void 0!==t.value&&null!==t.value&&e.toString()===t.value.toString()}),t.$on("$destroy",function(){n.scopes.splice(n.scopes.indexOf(t),1),0===n.scopes.length&&delete this.fieldNameToActiveRadioGroupDatumMap_[t.attribute]})},t}();e.RadioField=t,angular.module("formFor").directive("radioField",function(e,i){return new t(e,i)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(e){this.formForConfiguration_=e}return t.prototype.manageLabel=function(t,i,r){i.hasOwnProperty("label")&&i.$observe("label",function(e){t.label=e}),this.formForConfiguration_.autoGenerateLabels&&(t.label=e.StringUtil.humanize(r?t.value:t.attribute))},t.prototype.manageFieldRegistration=function(e,t,i){e.$watch("attribute",function(r,o){e.model&&i.unregisterFormField(o),e.model=i.registerFormField(e.attribute),t.uid&&(e.model.uid=t.uid)}),e.$on("$destroy",function(){i.unregisterFormField(e.attribute)})},t}();e.FieldHelper=t,angular.module("formFor").service("FieldHelper",function(e){return new t(e)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e,t,i,r,o){this.require="^formFor",this.restrict="EA",this.templateUrl="form-for/templates/select-field.html",this.scope={attribute:"@",disable:"=",filter:"=?",filterDebounce:"@?",help:"@?",multiple:"=?",options:"="},this.$document_=e,this.$log_=t,this.$timeout_=i,this.$window_=angular.element(r),this.fieldHelper_=o}return e.prototype.link=function(t,i,r,o){var n=this;if(!t.attribute)return void this.$log_.error('Missing required field "attribute"');t.allowBlank=r.hasOwnProperty("allowBlank"),t.enableFiltering=r.hasOwnProperty("enableFiltering"),t.preventDefaultOption=r.hasOwnProperty("preventDefaultOption"),t.labelAttribute=r.labelAttribute||"label",t.valueAttribute=r.valueAttribute||"value",t.placeholder=r.placeholder||"Select",t.tabIndex=r.tabIndex||0,this.fieldHelper_.manageLabel(t,r,!1),this.fieldHelper_.manageFieldRegistration(t,r,o);var a=function(e){var t=e[0];n.$timeout_(t.focus.bind(t))};t.close=function(){n.$timeout_(function(){t.isOpen=!1})},t.open=function(){t.disable||t.model.disabled||n.$timeout_(function(){t.isOpen=!0})},t.emptyOption={},t.emptyOption[t.labelAttribute]="",t.emptyOption[t.valueAttribute]=void 0,t.placeholderOption={},t.placeholderOption[t.labelAttribute]=t.placeholder,t.placeholderOption[t.valueAttribute]=void 0,t.filteredOptions=[];var l=function(e){return e&&e.toLowerCase()},s=function(){var e=t.options||[];if(t.filteredOptions.splice(0),t.enableFiltering&&t.filter){var i=l(t.filter);angular.forEach(e,function(e){var r=l(e[t.labelAttribute]).indexOf(i);r>=0&&t.filteredOptions.push(e)})}else angular.copy(e,t.filteredOptions);t.selectedOption||t.multiple?t.allowBlank&&t.filteredOptions.unshift(t.emptyOption):t.filteredOptions.unshift(t.placeholderOption)};t.$watch("filter",s),t.$watch("options.length",s);var u=function(){var e=t.selectedOption&&t.selectedOption[t.valueAttribute];t.model.bindable===e&&!t.allowBlank&&!t.preventDefaultOption&&t.options&&t.options.length&&(t.model.bindable=t.options[0][t.valueAttribute])};t.$watch("model.bindable",u),t.$watch("options.length",u),t.$watch("model.bindable",function(){var e=null;angular.forEach(t.options,function(i){i[t.valueAttribute]===t.model.bindable&&(e=i)}),t.selectedOption=e,t.selectedOptionLabel=e&&e[t.labelAttribute],t.filter=t.selectedOptionLabel});var d=function(e){e.ignoreFor!==t.model.uid&&t.close()};t.filterTextClick=function(e){t.isOpen&&(e.ignoreFor=t.model.uid)};var c;t.$watch("isOpen",function(){c&&n.$timeout_.cancel(c),c=n.$timeout_(function(){c=null,t.isOpen?n.$document_.on("click",void 0,d):n.$document_.off("click",void 0,d)},e.MIN_TIMEOUT_INTERVAL)}),t.$on("$destroy",function(){n.$document_.off("click",d)});var f=i.find("input");t.setFilterFocus=function(){a(f)},t.mouseOver=function(e){t.mouseOverIndex=e,t.mouseOverOption=e>=0?t.filteredOptions[e]:null},t.selectOption=function(e){t.model.bindable=e&&e[t.valueAttribute]},t.keyDown=function(e){switch(e.keyCode){case 27:t.close();break;case 13:t.isOpen?(t.selectOption(t.mouseOverOption),t.close()):t.open(),e.preventDefault();break;case 38:t.isOpen?t.mouseOver(t.mouseOverIndex>0?t.mouseOverIndex-1:t.filteredOptions.length-1):t.open();break;case 40:t.isOpen?t.mouseOver(t.mouseOverIndex<t.filteredOptions.length-1?t.mouseOverIndex+1:0):t.open();break;case 9:case 16:t.close();break;default:t.open()}},t.$watchCollection("[isOpen, filteredOptions.length]",function(){t.mouseOver(-1),t.isOpen&&t.enableFiltering&&a(f)})},e.MIN_TIMEOUT_INTERVAL=10,e}();e.SelectField=t,angular.module("formFor").directive("selectField",function(e,i,r,o,n){return new t(e,i,r,o,n)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e){this.require="^formFor",this.restrict="EA",this.templateUrl="form-for/templates/submit-button.html",this.scope={disable:"=",icon:"@",label:"@"},this.$sce_=e}return e.prototype.link=function(e,t,i,r){e.buttonClass=i.buttonClass,e.tabIndex=i.tabIndex||0,e.$watch("label",function(t){e.bindableLabel=this.$sce_.trustAsHtml(t)}),e.model=r.registerSubmitButton(e)},e}();e.SubmitButton=t,angular.module("formFor").directive("submitButton",function(e){return new t(e)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e,t,i){this.require="^formFor",this.restrict="EA",this.templateUrl="form-for/templates/text-field.html",this.scope={attribute:"@",debounce:"@?",disable:"=",focused:"&?",blurred:"&?",help:"@?",iconAfterClicked:"&?",iconBeforeClicked:"&?",placeholder:"@?",rows:"=?"},this.$log_=e,this.$timeout_=t,this.fieldHelper_=i}return e.prototype.link=function(e,t,i,r){if(!e.attribute)return void this.$log_.error('Missing required field "attribute"');if(e.attributes=i,e.rows=e.rows||3,e.type=i.type||"text",e.multiline=i.hasOwnProperty("multiline")&&"false"!==i.multiline,e.tabIndex=i.tabIndex||0,i.hasOwnProperty("autofocus")&&this.$timeout_(function(){t.find(e.multiline?"textarea":"input")[0].focus()}),this.fieldHelper_.manageLabel(e,i,!1),this.fieldHelper_.manageFieldRegistration(e,i,r),i.iconAfter){var o=function(){if(e.model){var t="{"===i.iconAfter.charAt(0)?e.$eval(i.iconAfter):i.iconAfter;e.iconAfter=angular.isObject(t)?e.model.error?t.invalid:e.model.pristine?t.pristine:t.valid:t}};i.$observe("iconAfter",o),e.$watch("model.error",o),e.$watch("model.pristine",o)}if(i.iconBefore){var n=function(){if(e.model){var t="{"===i.iconBefore.charAt(0)?e.$eval(i.iconBefore):i.iconBefore;e.iconBefore=angular.isObject(t)?e.model.error?t.invalid:e.model.pristine?t.pristine:t.valid:t}};i.$observe("iconBefore",n),e.$watch("model.error",n),e.$watch("model.pristine",n)}e.onIconAfterClick=function(){i.hasOwnProperty("iconAfterClicked")&&e.iconAfterClicked()},e.onIconBeforeClick=function(){i.hasOwnProperty("iconBeforeClicked")&&e.iconBeforeClicked()},e.onFocus=function(){i.hasOwnProperty("focused")&&e.focused()},e.onBlur=function(){i.hasOwnProperty("blurred")&&e.blurred()}},e}();e.TextField=t,angular.module("formFor").directive("textField",function(e,i,r){return new t(e,i,r)})}(formFor||(formFor={}));var formFor;!function(e){!function(e){e[e.COLLECTION_MAX_SIZE="COLLECTION_MAX_SIZE"]="COLLECTION_MAX_SIZE",e[e.COLLECTION_MIN_SIZE="COLLECTION_MIN_SIZE"]="COLLECTION_MIN_SIZE",e[e.CUSTOM="CUSTOM"]="CUSTOM",e[e.MAX_LENGTH="MAX_LENGTH"]="MAX_LENGTH",e[e.MIN_LENGTH="MIN_LENGTH"]="MIN_LENGTH",e[e.PATTERN="PATTERN"]="PATTERN",e[e.REQUIRED="REQUIRED_FIELD"]="REQUIRED",e[e.TYPE_EMAIL="TYPE_EMAIL"]="TYPE_EMAIL",e[e.TYPE_INTEGER="TYPE_INTEGER"]="TYPE_INTEGER",e[e.TYPE_NEGATIVE="TYPE_NEGATIVE"]="TYPE_NEGATIVE",e[e.TYPE_NON_NEGATIVE="TYPE_NON_NEGATIVE"]="TYPE_NON_NEGATIVE",e[e.TYPE_NUMERIC="TYPE_NUMERIC"]="TYPE_NUMERIC",e[e.TYPE_POSITIVE="TYPE_POSITIVE"]="TYPE_POSITIVE"}(e.ValidationFailureType||(e.ValidationFailureType={}));e.ValidationFailureType}(formFor||(formFor={}));var formFor;!function(e){!function(e){e[e.EMAIL="email"]="EMAIL",e[e.INTEGER="integer"]="INTEGER",e[e.NEGATIVE="negative"]="NEGATIVE",e[e.NON_NEGATIVE="nonNegative"]="NON_NEGATIVE",e[e.NUMBER="number"]="NUMBER",e[e.POSITIVE="positive"]="POSITIVE"}(e.ValidationFieldType||(e.ValidationFieldType={}));e.ValidationFieldType}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(){}return e}();e.BindableFieldWrapper=t}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t,i,r,o){this.$interpolate_=t,this.formForConfiguration_=o,this.nestedObjectHelper_=new e.NestedObjectHelper(i),this.promiseUtils_=new e.PromiseUtils(r)}return t.prototype.isCollectionRequired=function(e,t){var i=this.getRulesFor_(e,t);return i&&i.collection&&i.collection.min?angular.isObject(i.collection.min)?i.collection.min.rule>0:i.collection.min>0:!1},t.prototype.isFieldRequired=function(e,t){var i=this.getRulesFor_(e,t);return i&&i.required?angular.isObject(i.required)?i.required.rule:!!i.required:!1},t.prototype.validateAll=function(e,t){var i=this.nestedObjectHelper_.flattenObjectKeys(e);return this.validateFields(e,i,t)},t.prototype.validateCollection=function(e,t,i){var r=this.getRulesFor_(t,i),o=this.nestedObjectHelper_.readAttribute(e,t);return r&&r.collection?(o=o||[],this.validateCollectionMinLength_(o,r.collection)||this.validateCollectionMaxLength_(o,r.collection)||this.promiseUtils_.resolve()):this.promiseUtils_.resolve()},t.prototype.validateField=function(e,t,i){var r=this.getRulesFor_(t,i),o=this.nestedObjectHelper_.readAttribute(e,t);return r?((void 0===o||null===o)&&(o=""),this.validateFieldRequired_(o,r)||this.validateFieldMinLength_(o,r)||this.validateFieldMaxLength_(o,r)||this.validateFieldType_(o,r)||this.validateFieldPattern_(o,r)||this.validateFieldCustom_(o,e,r)||this.promiseUtils_.resolve()):this.promiseUtils_.resolve()},t.prototype.validateFields=function(e,t,i){var r=this,o=this.promiseUtils_.defer(),n=[],a={};return angular.forEach(t,function(t){var o=r.getRulesFor_(t,i);if(o){var l;l=o.collection?r.validateCollection(e,t,i):r.validateField(e,t,i),l.then(angular.noop,function(e){r.nestedObjectHelper_.writeAttribute(a,t,e)}),n.push(l)}},this),this.promiseUtils_.waitForAll(n).then(o.resolve,function(){o.reject(a)}),o.promise},t.prototype.getRulesFor_=function(e,t){var i=e.replace(/\[[^\]]+\]/g,".collection.fields");return this.nestedObjectHelper_.readAttribute(t,i)},t.prototype.getFieldTypeFailureMessage_=function(e,t){return angular.isObject(e.type)?e.type.message:this.formForConfiguration_.getFailedValidationMessage(t)},t.isConsideredNumeric_=function(e,t){return e&&!isNaN(t)},t.prototype.validateCollectionMinLength_=function(t,i){if(i.min){var r=angular.isObject(i.min)?i.min.rule:i.min;if(t.length<r){var o;return o=angular.isObject(i.min)?i.min.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.COLLECTION_MIN_SIZE))({num:r}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateCollectionMaxLength_=function(t,i){if(i.max){var r=angular.isObject(i.max)?i.max.rule:i.max;if(t.length>r){var o;return o=angular.isObject(i.max)?i.max.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.COLLECTION_MAX_SIZE))({num:r}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateFieldCustom_=function(t,i,r){var o=this;if(r.custom){var n,a;angular.isFunction(r.custom)?(n=this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.CUSTOM),a=r.custom):(n=r.custom.message,a=r.custom.rule);
try{var l=a(t,i)}catch(s){return this.promiseUtils_.reject(s.message||n)}return angular.isObject(l)&&angular.isFunction(l.then)?l.then(function(e){return o.promiseUtils_.resolve(e)},function(e){return o.promiseUtils_.reject(e||n)}):l?this.promiseUtils_.resolve(l):this.promiseUtils_.reject(n)}return null},t.prototype.validateFieldMaxLength_=function(t,i){if(i.maxlength){var r=angular.isObject(i.maxlength)?i.maxlength.rule:i.maxlength;if(t.length>r){var o;return o=angular.isObject(i.maxlength)?i.maxlength.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.MAX_LENGTH))({num:r}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateFieldMinLength_=function(t,i){if(i.minlength){var r=angular.isObject(i.minlength)?i.minlength.rule:i.minlength;if(t&&t.length<r){var o;return o=angular.isObject(i.minlength)?i.minlength.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.MIN_LENGTH))({num:r}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateFieldRequired_=function(t,i){if(i.required){var r=angular.isObject(i.required)?i.required.rule:i.required;if(angular.isString(t)&&(t=t.replace(/\s+$/,"")),r&&!t){var o;return o=angular.isObject(i.required)?i.required.message:this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.REQUIRED),this.promiseUtils_.reject(o)}}return null},t.prototype.validateFieldPattern_=function(t,i){if(i.pattern){var r=i.pattern instanceof RegExp,o=r?i.pattern:i.pattern.rule;if(!o.exec(t)){var n=r?this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.PATTERN):i.pattern.message;return this.promiseUtils_.reject(n)}}return null},t.prototype.validateFieldType_=function(i,r){if(r.type){var o=angular.isObject(r.type)?r.type.rule:r.type,n=i.toString(),a=Number(i);if(o)for(var l=o.split(" "),s=0,u=l.length;u>s;s++){var d=l[s];switch(d){case e.ValidationFieldType.INTEGER:if(n&&(isNaN(a)||a%1!==0))return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(r,e.ValidationFailureType.TYPE_INTEGER));break;case e.ValidationFieldType.NUMBER:if(n&&isNaN(a))return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(r,e.ValidationFailureType.TYPE_NUMERIC));break;case e.ValidationFieldType.NEGATIVE:if(t.isConsideredNumeric_(n,a)&&a>=0)return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(r,e.ValidationFailureType.TYPE_NEGATIVE));break;case e.ValidationFieldType.NON_NEGATIVE:if(t.isConsideredNumeric_(n,a)&&0>a)return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(r,e.ValidationFailureType.TYPE_NON_NEGATIVE));break;case e.ValidationFieldType.POSITIVE:if(t.isConsideredNumeric_(n,a)&&0>=a)return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(r,e.ValidationFailureType.TYPE_POSITIVE));break;case e.ValidationFieldType.EMAIL:if(n&&!n.match(/^.+@.+$/))return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(r,e.ValidationFailureType.TYPE_EMAIL))}}}return null},t}();e.ModelValidator=t,angular.module("formFor").service("ModelValidator",function(e,i,r,o){return new t(e,i,r,o)})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t,i){this.$scope_=i,this.nestedObjectHelper_=new e.NestedObjectHelper(t),this.$scope_.fieldNameToErrorMap=i.fieldNameToErrorMap||{},this.$scope_.valid=!0,this.fieldNameToModifiedStateMap_={},this.formSubmitted_=!1,this.fieldNameToErrorMap_={},this.watchableCounter_=0}return t.prototype.getFieldError=function(e){return this.nestedObjectHelper_.readAttribute(this.$scope_.fieldNameToErrorMap,e)},t.prototype.hasFieldBeenModified=function(e){return this.nestedObjectHelper_.readAttribute(this.fieldNameToModifiedStateMap_,e)},t.prototype.hasFormBeenSubmitted=function(){return this.formSubmitted_},t.prototype.isFormInvalid=function(){return!this.isFormValid()},t.prototype.isFormValid=function(){for(var e in this.fieldNameToErrorMap_)return!1;return!0},t.prototype.resetFieldErrors=function(){this.$scope_.fieldNameToErrorMap={}},t.prototype.setFieldError=function(e,t){var i=this.nestedObjectHelper_.flattenAttribute(e);this.nestedObjectHelper_.writeAttribute(this.$scope_.fieldNameToErrorMap,e,t),t?this.fieldNameToErrorMap_[i]=t:delete this.fieldNameToErrorMap_[i],this.$scope_.valid=this.isFormValid(),this.watchableCounter_++},t.prototype.setFieldHasBeenModified=function(e,t){this.nestedObjectHelper_.writeAttribute(this.fieldNameToModifiedStateMap_,e,t),this.watchableCounter_++},t.prototype.setFormSubmitted=function(e){this.formSubmitted_=e,this.watchableCounter_++},t}();e.FormForStateHelper=t}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(){}return e.humanize=function(e){return e?(e=e.replace(/[A-Z]/g,function(e){return" "+e}),e=e.replace(/_([a-z])/g,function(e,t){return" "+t.toUpperCase()}),e=e.replace(/\s+/g," "),e=e.trim(),e=e.charAt(0).toUpperCase()+e.slice(1)):""},e}();e.StringUtil=t}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));
//# sourceMappingURL=angular-form-for.min.js.map