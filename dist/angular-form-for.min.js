angular.module("formFor",[]);var ValidationFailureType;!function(e){e[e.COLLECTION_MAX_SIZE="COLLECTION_MAX_SIZE"]="COLLECTION_MAX_SIZE",e[e.COLLECTION_MIN_SIZE="COLLECTION_MIN_SIZE"]="COLLECTION_MIN_SIZE",e[e.CUSTOM="CUSTOM"]="CUSTOM",e[e.MAX_LENGTH="MAX_LENGTH"]="MAX_LENGTH",e[e.MIN_LENGTH="MIN_LENGTH"]="MIN_LENGTH",e[e.PATTERN="PATTERN"]="PATTERN",e[e.REQUIRED="REQUIRED_FIELD"]="REQUIRED",e[e.TYPE_EMAIL="TYPE_EMAIL"]="TYPE_EMAIL",e[e.TYPE_INTEGER="TYPE_INTEGER"]="TYPE_INTEGER",e[e.TYPE_NEGATIVE="TYPE_NEGATIVE"]="TYPE_NEGATIVE",e[e.TYPE_NON_NEGATIVE="TYPE_NON_NEGATIVE"]="TYPE_NON_NEGATIVE",e[e.TYPE_NUMERIC="TYPE_NUMERIC"]="TYPE_NUMERIC",e[e.TYPE_POSITIVE="TYPE_POSITIVE"]="TYPE_POSITIVE"}(ValidationFailureType||(ValidationFailureType={}));var ValidationFieldType;!function(e){e[e.EMAIL="email"]="EMAIL",e[e.INTEGER="integer"]="INTEGER",e[e.NEGATIVE="negative"]="NEGATIVE",e[e.NON_NEGATIVE="nonNegative"]="NON_NEGATIVE",e[e.NUMBER="number"]="NUMBER",e[e.POSITIVE="positive"]="POSITIVE"}(ValidationFieldType||(ValidationFieldType={}));var FormForConfiguration=function(){function e(){this.autoGenerateLabels_=!1,this.defaultDebounceDuration_=500,this.defaultSubmitComplete_=function(){},this.defaultSubmitError_=function(){},this.defaultValidationFailed_=function(){},this.requiredLabel_=null,this.validationFailedForCustomMessage_="Failed custom validation",this.validationFailedForEmailTypeMessage_="Invalid email format",this.validationFailedForIntegerTypeMessage_="Must be an integer",this.validationFailedForMaxCollectionSizeMessage_="Must be fewer than {{num}} items",this.validationFailedForMaxLengthMessage_="Must be fewer than {{num}} characters",this.validationFailedForMinCollectionSizeMessage_="Must at least {{num}} items",this.validationFailedForMinLengthMessage_="Must be at least {{num}} characters",this.validationFailedForNegativeTypeMessage_="Must be negative",this.validationFailedForNonNegativeTypeMessage_="Must be non-negative",this.validationFailedForNumericTypeMessage_="Must be numeric",this.validationFailedForPatternMessage_="Invalid format",this.validationFailedForPositiveTypeMessage_="Must be positive",this.validationFailedForRequiredMessage_="Required field"}return Object.defineProperty(e.prototype,"autoGenerateLabels",{get:function(){return this.autoGenerateLabels_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultDebounceDuration",{get:function(){return this.defaultDebounceDuration_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultSubmitComplete",{get:function(){return this.defaultSubmitComplete_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultSubmitError",{get:function(){return this.defaultSubmitError_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultValidationFailed",{get:function(){return this.defaultValidationFailed_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requiredLabel",{get:function(){return this.requiredLabel_},enumerable:!0,configurable:!0}),e.prototype.disableAutoLabels=function(){this.autoGenerateLabels_=!1},e.prototype.enableAutoLabels=function(){this.autoGenerateLabels_=!0},e.prototype.getFailedValidationMessage=function(e){switch(e){case ValidationFailureType.CUSTOM:return this.validationFailedForCustomMessage_;case ValidationFailureType.COLLECTION_MAX_SIZE:return this.validationFailedForMaxCollectionSizeMessage_;case ValidationFailureType.COLLECTION_MIN_SIZE:return this.validationFailedForMinCollectionSizeMessage_;case ValidationFailureType.MAX_LENGTH:return this.validationFailedForMaxLengthMessage_;case ValidationFailureType.MIN_LENGTH:return this.validationFailedForMinLengthMessage_;case ValidationFailureType.PATTERN:return this.validationFailedForPatternMessage_;case ValidationFailureType.REQUIRED:return this.validationFailedForRequiredMessage_;case ValidationFailureType.TYPE_EMAIL:return this.validationFailedForEmailTypeMessage_;case ValidationFailureType.TYPE_INTEGER:return this.validationFailedForIntegerTypeMessage_;case ValidationFailureType.TYPE_NEGATIVE:return this.validationFailedForNegativeTypeMessage_;case ValidationFailureType.TYPE_NON_NEGATIVE:return this.validationFailedForNonNegativeTypeMessage_;case ValidationFailureType.TYPE_NUMERIC:return this.validationFailedForNumericTypeMessage_;case ValidationFailureType.TYPE_POSITIVE:return this.validationFailedForPositiveTypeMessage_}},e.prototype.setDefaultDebounceDuration=function(e){this.defaultDebounceDuration_=e},e.prototype.setDefaultSubmitComplete=function(e){this.defaultSubmitComplete_=e},e.prototype.setDefaultSubmitError=function(e){this.defaultSubmitError_=e},e.prototype.setDefaultValidationFailed=function(e){this.defaultValidationFailed_=e},e.prototype.setRequiredLabel=function(e){this.requiredLabel_=e},e.prototype.setValidationFailedForCustomMessage=function(e){this.validationFailedForCustomMessage_=e},e.prototype.setValidationFailedForMaxCollectionSizeMessage=function(e){this.validationFailedForMaxCollectionSizeMessage_=e},e.prototype.setValidationFailedForMaxLengthMessage=function(e){this.validationFailedForMaxLengthMessage_=e},e.prototype.setValidationFailedForMinCollectionSizeMessage=function(e){this.validationFailedForMaxCollectionSizeMessage_=e},e.prototype.setValidationFailedForMinLengthMessage=function(e){this.validationFailedForMinLengthMessage_=e},e.prototype.setValidationFailedForPatternMessage=function(e){this.validationFailedForPatternMessage_=e},e.prototype.setValidationFailedForRequiredMessage=function(e){this.validationFailedForRequiredMessage_=e},e.prototype.setValidationFailedForEmailTypeMessage=function(e){this.validationFailedForEmailTypeMessage_=e},e.prototype.setValidationFailedForIntegerTypeMessage=function(e){this.validationFailedForIntegerTypeMessage_=e},e.prototype.setValidationFailedForNegativeTypeMessage=function(e){this.validationFailedForNegativeTypeMessage_=e},e.prototype.setValidationFailedForNonNegativeTypeMessage=function(e){this.validationFailedForNonNegativeTypeMessage_=e},e.prototype.setValidationFailedForNumericTypeMessage=function(e){this.validationFailedForNumericTypeMessage_=e},e.prototype.setValidationFailedForPositiveTypeMessage=function(e){this.validationFailedForPositiveTypeMessage_=e},e}();angular.module("formFor").service("FormForConfiguration",function(){return new FormForConfiguration});var NestedObjectHelper=function(){function e(e){this.$parse_=e}return e.prototype.flattenAttribute=function(e){return e.replace(/\[([^\]]+)\]\.{0,1}/g,"___$1___").replace(/\./g,"___")},e.prototype.flattenObjectKeys=function(e){for(var t=[],i=[{object:e,prefix:null}];;){if(0===i.length)break;var a=i.pop(),r=a.prefix?a.prefix+".":"";if("object"==typeof a.object)for(var n in a.object){var o=r+n;t.push(o),i.push({object:a.object[n],prefix:o})}}return t},e.prototype.readAttribute=function(e,t){return this.$parse_(t)(e)},e.prototype.writeAttribute=function(e,t,i){this.initializeArraysAndObjectsForParse_(e,t),this.$parse_(t).assign(e,i)},e.prototype.initializeArraysAndObjectsForParse_=function(e,t){for(var i=0;;){if(i=t.indexOf("[",i),0>i)break;var a=t.substr(0,i),r=this.readAttribute(e,a);r||(r=[],this.writeAttribute(e,a,r));var n=t.substr(i).match(/([0-9]+)\]\./);if(n){var o=parseInt(n[1]);r[o]||(r[o]={})}i++}},e}();angular.module("formFor").service("NestedObjectHelper",function(e){return new NestedObjectHelper(e)});var PromiseUtils=function(){function e(e){this.$q_=e}return e.prototype.resolve=function(e){var t=this.$q_.defer();return t.resolve(e),t.promise},e.prototype.waitForAll=function(e){function t(e,t){r.hasOwnProperty(e)||(r[e]=t,n--),i()}function i(){0===n&&(o?a.reject(r):a.resolve(r))}var a=this.$q_.defer(),r={},n=0,o=!1;return angular.forEach(e,function(e,i){n++,e.then(function(e){t(i,e)},function(e){o=!0,t(i,e)})}),i(),a.promise},e}();angular.module("formFor").service("PromiseUtils",function(e){return new PromiseUtils(e)});var ModelValidator=function(){function e(e,t,i,a,r){this.$interpolate_=e,this.$q_=t,this.formForConfiguration_=i,this.nestedObjectHelper_=a,this.promiseUtils_=r}return e.prototype.isCollectionRequired=function(e,t){var i=this.getRulesFor_(e,t);return i&&i.collection&&i.collection.min?angular.isObject(i.collection.min)?i.collection.min.rule>0:i.collection.min>0:!1},e.prototype.isFieldRequired=function(e,t){var i=this.getRulesFor_(e,t);return i&&i.required?angular.isObject(i.required)?i.required.rule:!!i.required:!1},e.prototype.validateAll=function(e,t){var i=this.nestedObjectHelper_.flattenObjectKeys(e);return this.validateFields(e,i,t)},e.prototype.validateCollection=function(e,t,i){var a=this.getRulesFor_(t,i),r=this.nestedObjectHelper_.readAttribute(e,t);return a&&a.collection?(r=r||[],this.validateCollectionMinLength_(r,a.collection)||this.validateCollectionMaxLength_(r,a.collection)||this.promiseUtils_.resolve()):this.promiseUtils_.resolve()},e.prototype.validateField=function(e,t,i){var a=this.getRulesFor_(t,i),r=this.nestedObjectHelper_.readAttribute(e,t);return a?((void 0===r||null===r)&&(r=""),this.validateFieldRequired_(r,a)||this.validateFieldMinLength_(r,a)||this.validateFieldMaxLength_(r,a)||this.validateFieldType_(r,a)||this.validateFieldPattern_(r,a)||this.validateFieldCustom_(r,e,a)||this.promiseUtils_.resolve()):this.promiseUtils_.resolve()},e.prototype.validateFields=function(e,t,i){var a=this,r=this.$q_.defer(),n=[],o={};return angular.forEach(t,function(t){var r=a.getRulesFor_(t,i);if(r){var l;l=r.collection?a.validateCollection(e,t,i):a.validateField(e,t,i),l.then(angular.noop,function(e){a.nestedObjectHelper_.writeAttribute(o,t,e)}),n.push(l)}},this),this.promiseUtils_.waitForAll(n).then(r.resolve,function(){r.reject(o)}),r.promise},e.prototype.getRulesFor_=function(e,t){var i=e.replace(/\[[^\]]+\]/g,".collection.fields");return this.nestedObjectHelper_.readAttribute(t,i)},e.prototype.getFieldTypeFailureMessage_=function(e,t){return angular.isObject(e.type)?e.type.message:this.formForConfiguration_.getFailedValidationMessage(t)},e.prototype.isConsideredNumeric_=function(e,t){return e&&!isNaN(t)},e.prototype.validateCollectionMinLength_=function(e,t){if(t.min){var i=angular.isObject(t.min)?t.min.rule:t.min;if(e.length<i){var a;return a=angular.isObject(t.min)?t.min.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(ValidationFailureType.COLLECTION_MIN_SIZE))({num:i}),this.$q_.reject(a)}}return null},e.prototype.validateCollectionMaxLength_=function(e,t){if(t.max){var i=angular.isObject(t.max)?t.max.rule:t.max;if(e.length>i){var a;return a=angular.isObject(t.max)?t.max.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(ValidationFailureType.COLLECTION_MAX_SIZE))({num:i}),this.$q_.reject(a)}}return null},e.prototype.validateFieldCustom_=function(e,t,i){var a=this;if(i.custom){var r,n;angular.isFunction(i.custom)?(r=this.formForConfiguration_.getFailedValidationMessage(ValidationFailureType.CUSTOM),n=i.custom):(r=i.custom.message,n=i.custom.rule);try{var o=n(e,t)}catch(l){return this.$q_.reject(l.message||r)}return angular.isObject(o)&&angular.isFunction(o.then)?o.then(function(e){return a.promiseUtils_.resolve(e)},function(e){return a.$q_.reject(e||r)}):o?this.promiseUtils_.resolve(o):this.$q_.reject(r)}return null},e.prototype.validateFieldMaxLength_=function(e,t){if(t.maxlength){var i=angular.isObject(t.maxlength)?t.maxlength.rule:t.maxlength;if(e.length>i){var a;return a=angular.isObject(t.maxlength)?t.maxlength.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(ValidationFailureType.MAX_LENGTH))({num:i}),this.$q_.reject(a)}}return null},e.prototype.validateFieldMinLength_=function(e,t){if(t.minlength){var i=angular.isObject(t.minlength)?t.minlength.rule:t.minlength;if(e&&e.length<i){var a;return a=angular.isObject(t.minlength)?t.minlength.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(ValidationFailureType.MIN_LENGTH))({num:i}),this.$q_.reject(a)}}return null},e.prototype.validateFieldRequired_=function(e,t){if(t.required){var i=angular.isObject(t.required)?t.required.rule:t.required;if(angular.isString(e)&&(e=e.replace(/\s+$/,"")),i&&!e){var a;return a=angular.isObject(t.required)?t.required.message:this.formForConfiguration_.getFailedValidationMessage(ValidationFailureType.REQUIRED),this.$q_.reject(a)}}return null},e.prototype.validateFieldPattern_=function(e,t){if(t.pattern){var i=t.pattern instanceof RegExp,a=i?t.pattern:t.pattern.rule;if(!a.exec(e)){var r=i?this.formForConfiguration_.getFailedValidationMessage(ValidationFailureType.PATTERN):t.pattern.message;return this.$q_.reject(r)}}return null},e.prototype.validateFieldType_=function(e,t){if(t.type){var i=angular.isObject(t.type)?t.type.rule:t.type,a=e.toString(),r=Number(e);if(i)for(var n=i.split(" "),o=0,l=n.length;l>o;o++){var s=n[o];switch(s){case ValidationFieldType.INTEGER:if(a&&(isNaN(r)||r%1!==0))return this.$q_.reject(this.getFieldTypeFailureMessage_(t,ValidationFailureType.TYPE_INTEGER));break;case ValidationFieldType.NUMBER:if(a&&isNaN(r))return this.$q_.reject(this.getFieldTypeFailureMessage_(t,ValidationFailureType.TYPE_NUMERIC));break;case ValidationFieldType.NEGATIVE:if(this.isConsideredNumeric_(a,r)&&r>=0)return this.$q_.reject(this.getFieldTypeFailureMessage_(t,ValidationFailureType.TYPE_NEGATIVE));break;case ValidationFieldType.NON_NEGATIVE:if(this.isConsideredNumeric_(a,r)&&0>r)return this.$q_.reject(this.getFieldTypeFailureMessage_(t,ValidationFailureType.TYPE_NON_NEGATIVE));break;case ValidationFieldType.POSITIVE:if(this.isConsideredNumeric_(a,r)&&0>=r)return this.$q_.reject(this.getFieldTypeFailureMessage_(t,ValidationFailureType.TYPE_POSITIVE));break;case ValidationFieldType.EMAIL:if(a&&!a.match(/^.+@.+$/))return this.$q_.reject(this.getFieldTypeFailureMessage_(t,ValidationFailureType.TYPE_EMAIL))}}}return null},e}();angular.module("formFor").service("ModelValidator",function(e,t,i,a,r){return new ModelValidator(e,t,i,a,r)});
//# sourceMappingURL=angular-form-for.min.js.map