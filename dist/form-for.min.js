angular.module("formFor.templates",[]).run(["$templateCache",function(e){e.put("form-for/templates/checkbox-field.html",'<div  class="field checkbox-field"\n      ng-class="{disabled: disable || model.disabled, \'has-error\': model.error}">\n\n  <field-error error="model.error" left-aligned="true"></field-error>\n\n  <label>\n    <input  type="checkbox" class="field-input"\n            tabindex="{{tabIndex}}"\n            ng-model="model.bindable"\n            ng-disabled="disable || model.disabled">\n\n    <span class="checkbox-field-input" ng-class="{\'is-checked\': model.bindable}"></span>\n\n    <field-label  ng-if="label"\n                  label="{{label}}"\n                  help="{{help}}"\n                  ng-click="toggle()">\n    </field-label>\n  </label>\n</div>\n'),e.put("form-for/templates/collection-label.html",'<div class="collection-label" ng-class="{\'field-error\': model.error}">\n  <field-label  ng-if="label"\n                label="{{label}}"\n                help="{{help}}"\n                required="{{model.required}}">\n  </field-label>\n\n  <small ng-if="model.error" class="field-error" ng-bind="model.error"></small>\n</div>\n'),e.put("form-for/templates/field-error.html",'<p ng-if="error" class="field-error" ng-class="{\'left-aligned\': leftAligned}" ng-bind="error"></p>\n'),e.put("form-for/templates/field-label.html",'<label  class="field-label"\n        popover="{{help}}"\n        popover-trigger="mouseenter"\n        popover-placement="right">\n\n  <span ng-bind-html="bindableLabel"></span>\n\n  <span ng-if="help" class="fa-stack help-icon-stack">\n    <i class="fa fa-stack-2x fa-circle help-background-icon"></i>\n    <i class="fa fa-stack-1x fa-inverse fa-question help-foreground-icon"></i>\n  </span>\n\n  <span class="field-label-required-label" ng-if="requiredLabel" ng-bind="requiredLabel"></span>\n</label>\n'),e.put("form-for/templates/radio-field.html",'<span class="field radio-field"\n      ng-class="{disabled: disable || model.disabled, \'has-error\': model.error}">\n\n  <field-error error="model.error" left-aligned="true"></field-error>\n\n  <label>\n    <input  type="radio" class="field-input"\n            tabindex="{{tabIndex}}"\n            ng-model="model.bindable"\n            ng-value="value"\n            ng-checked="checked"\n            ng-disabled="disable || model.disabled">\n\n    <span class="radio-field-input" ng-class="{\'is-selected\': checked}"\n          ng-click="click()"></span>\n\n    <field-label  ng-if="label"\n                  label="{{label}}"\n                  help="{{help}}"\n                  ng-click="click()">\n    </field-label>\n  </label>\n</span>\n'),e.put("form-for/templates/select-field-loading-indicator.html",'<i class="fa fa-circle-o-notch fa-spin"></i>\nLoading...\n'),e.put("form-for/templates/select-field.html",'<div  class="field select-field"\n      ng-class="{ \'direction-down\': !dropUp,\n                  \'direction-up\': dropUp,\n                  \'disabled\': disable || model.disabled,\n                  \'has-error\': model.error,\n                  \'open\': isOpen }">\n\n  <field-label  ng-if="label"\n                label="{{label}}"\n                help="{{help}}"\n                required="{{model.required}}">\n  </field-label>\n\n  <field-error error="model.error"></field-error>\n\n  <button class="select-field-toggle-button"\n          tabindex="{{tabIndex}}"\n          ng-keydown="keyDown($event)"\n          ng-class="{open: isOpen, disabled: disable || model.disabled}"\n          ng-click="$event.preventDefault();"\n          ng-disabled="disable || model.disabled">\n\n    <span ng-if="selectedOptionLabel" class="pull-left" ng-bind="selectedOptionLabel"></span>\n\n    <span ng-if="!selectedOptionLabel">\n      <span ng-if="placeholder" ng-bind="placeholder"></span>\n      <span ng-if="!placeholder">Select</span>\n    </span>\n\n    <span class="fa fa-caret-down pull-right select-field-toggle-caret"></span>\n  </button>\n\n  <div ng-show="isOpen" class="list-group-container">\n    <div class="list-group">\n      <div  ng-show="enableFiltering" class="input-group filter-input-group"\n            ng-click="$event.stopPropagation()">\n        <input  type="text"\n                class="text-field-input filter-text-input"\n                tabindex="{{tabIndex}}"\n                ng-model="filter"\n                ng-keydown="keyDown($event)"\n                form-for-debounce="{{filterDebounce}}" />\n\n        <span class="input-group-addon input-group-addon-after">\n          <i class="fa fa-search text-field-icon"></i>\n        </span>\n      </div>\n\n      <div class="list-group-scrollable">\n        <a  class="list-group-item"\n            ng-repeat="option in filteredOptions"\n            ng-value="option[valueAttribute]"\n            ng-click="selectOption(option)"\n            ng-mouseenter="mouseOver($index)"\n            ng-class="{active: option === selectedOption, hover: $index === mouseOverIndex}">\n\n          <!-- Bootstrap leaves us no way to style a non-:hover element so we fall back to <strong> -->\n          <strong ng-if="$index === mouseOverIndex" ng-bind="option[labelAttribute]"></strong>\n          <span ng-if="$index !== mouseOverIndex" ng-bind="option[labelAttribute]"></span>\n          <spgn ng-if="!option[labelAttribute]">&nbsp;</spgn> <!-- Gracefully handle empty/null names -->\n        </a>\n\n        <a  ng-if="!options" class="list-group-item"\n            ng-include src="\'form-for/templates/select-field-loading-indicator.html\'"></a>\n      </div>\n    </div>\n  </div>\n</div>\n'),e.put("form-for/templates/submit-button.html",'<button class="submit-button" ng-class="buttonClass"\n        ng-disabled="disable || model.disabled"\n        tabindex="{{tabIndex}}">\n\n  <i ng-if="icon" class="submit-button-icon" ng-class="icon"></i>\n\n  <span ng-bind-html="bindableLabel"></span>\n</button>\n'),e.put("form-for/templates/text-field.html",'<div  class="field text-field"\n      ng-class="{disabled: disable || model.disabled, \'has-error\': model.error}">\n\n  <field-label  ng-if="label"\n                label="{{label}}"\n                help="{{help}}"\n                required="{{model.required}}">\n  </field-label>\n\n  <field-error error="model.error"></field-error>\n\n  <div ng-class="{\'input-group\': iconBefore || iconAfter}">\n    <span ng-if="iconBefore" class="input-group-addon input-group-addon-before"\n          ng-click="onIconBeforeClick()">\n      <i class="text-field-icon" ng-class="iconBefore"></i>\n    </span>\n\n    <input  ng-if="!multiline"\n            type="{{type}}"\n            tabindex="{{tabIndex}}"\n            class="text-field-input"\n            ng-class="{\'has-icon-before\': iconBefore, \'has-icon-after\': iconAfter}"\n            ng-disabled="disable || model.disabled"\n            placeholder="{{placeholder}}"\n            ng-model="model.bindable"\n            form-for-debounce="{{debounce}}"\n            ng-click="onFocus()" />\n\n    <textarea ng-if="multiline"\n              tabindex="{{tabIndex}}"\n              class="text-field-input"\n              ng-class="{\'has-icon-before\': iconBefore, \'has-icon-after\': iconAfter}"\n              ng-disabled="disable || model.disabled"\n              placeholder="{{placeholder}}"\n              ng-model="model.bindable"\n              form-for-debounce="{{debounce}}"\n              ng-click="onFocus()">\n    </textarea>\n\n    <span ng-if="iconAfter" class="input-group-addon input-group-addon-after"\n          ng-click="onIconAfterClick()">\n      <i class="text-field-icon" ng-class="iconAfter"></i>\n    </span>\n  </div>\n</div>\n')}]);
angular.module("formFor",["formFor.templates"]),angular.module("formFor").directive("checkboxField",["$log","FieldHelper",function(e,t){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/checkbox-field.html",scope:{attribute:"@",disable:"=",help:"@?"},link:function(i,r,o,a){if(!i.attribute)return void e.error('Missing required field "attribute"');i.label=t.getLabel(o,i.attribute),i.tabIndex=o.tabIndex||0;r.find("input");i.toggle=function(){i.disable||i.model.disabled||(i.model.bindable=!i.model.bindable)},t.manageFieldRegistration(i,a)}}}]),angular.module("formFor").directive("collectionLabel",["$sce","FormForConfiguration",function(e){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/collection-label.html",scope:{attribute:"@",help:"@?",label:"@"},link:function(t,i,r,o){t.$watch("label",function(i){t.bindableLabel=e.trustAsHtml(i)}),t.model=o.registerCollectionLabel(t.attribute)}}}]),angular.module("formFor").directive("fieldError",["$sce","FormForConfiguration",function(){return{restrict:"EA",templateUrl:"form-for/templates/field-error.html",scope:{error:"=",leftAligned:"@?"}}}]),angular.module("formFor").directive("fieldLabel",["$sce","FormForConfiguration",function(e,t){return{restrict:"EA",templateUrl:"form-for/templates/field-label.html",scope:{help:"@?",label:"@",required:"@?"},controller:["$scope",function(i){i.$watch("label",function(t){i.bindableLabel=e.trustAsHtml(t)}),i.$watch("required",function(e){i.requiredLabel=i.$eval(e)?t.requiredLabel:null})}]}}]),angular.module("formFor").directive("formForDebounce",["$log","$sniffer","$timeout","FormForConfiguration",function(e,t,i,r){return{restrict:"A",require:"ngModel",priority:99,link:function(o,a,n,l){if("radio"===n.type||"checkbox"===n.type)return void e.warn("formForDebounce should only be used with <input type=text> and <textarea> elements");var u,s=n.formForDebounce,d=r.defaultDebounceDuration;if(void 0!==s&&("false"===s.toString()?d=!1:(s=parseInt(s),angular.isNumber(s)&&!isNaN(s)&&(d=s))),t.hasEvent("input")?a.off("input"):(a.off("keydown"),t.hasEvent("paste")&&a.off("paste")),d!==!1){var c=function(){i.cancel(u),u=i(function(){o.$apply(function(){l.$setViewValue(a.val())})},d)};t.hasEvent("input")?a.on("input",c):(a.on("keydown",c),t.hasEvent("paste")&&a.on("paste",c))}a.on("blur",function(){o.$apply(function(){l.$setViewValue(a.val())})}),o.$on("$destroy",function(){u&&i.cancel(u)})}}}]),angular.module("formFor").directive("formFor",["$injector","$log","$parse","$q","$sce","FormForConfiguration","$FormForStateHelper","NestedObjectHelper","ModelValidator",function(e,t,i,r,o,a,n,l,u){return{require:"form",restrict:"A",scope:{controller:"=?",disable:"=?",formFor:"=",service:"@",submitComplete:"&?",submitError:"&?",submitWith:"&?",valid:"=?",validationFailed:"&?",validationRules:"=?"},controller:["$scope",function(a){a.formFor||t.error('The form data object specified by <form form-for=""> is null or undefined.'),a.fields={},a.collectionLabels={},a.buttons=[],a.service&&(a.$service=e.get(a.service)),a.$validationRules=a.$service?a.$service.validationRules:a.validationRules;var s=this;s.registerFormField=function(e){var t=l.flattenAttribute(e),r=(l.readAttribute(a.$validationRules,e),{bindableWrapper:{bindable:null,disabled:!1,error:null,pristine:!0,required:u.isFieldRequired(e,a.$validationRules)},fieldName:e,unwatchers:[],validationAttribute:e.split("[")[0]});a.fields[t]=r;var o=i(e),n=o.assign;r.unwatchers.push(a.$watch("fields."+t+".bindableWrapper.bindable",function(e,t){e!==t&&n(a.formFor,e)}));var d;return r.unwatchers.push(a.$watch("formFor."+e,function(i,o){(i!==r.bindableWrapper.bindable||void 0===o&&""===i||void 0===i)&&(d=!1),r.bindableWrapper.bindable=i,s.validateField(e),d||(d=!0,a.formForStateHelper.setFieldHasBeenModified(t,!1)),r.bindableWrapper.pristine=!a.formForStateHelper.hasFieldBeenModified(t)})),r.bindableWrapper},this.unregisterFormField=function(e){var t=l.flattenAttribute(e);angular.forEach(a.fields[t].unwatchers,function(e){e()}),delete a.fields[t]},s.registerSubmitButton=function(){var e={disabled:!1};return a.buttons.push(e),e},s.registerCollectionLabel=function(e){var t=l.flattenAttribute(e),i={error:null,required:u.isCollectionRequired(e,a.$validationRules)};a.collectionLabels[t]=i;var r=!1;return a.$watch("formFor."+e+".length",function(){r?u.validateCollection(a.formFor,e,a.$validationRules).then(function(){a.formForStateHelper.setFieldError(t,null)},function(e){a.formForStateHelper.setFieldError(t,e)}):r=!0}),i},s.resetField=function(e){var t=l.flattenAttribute(e);a.formForStateHelper.getFieldError(t)&&(a.formForStateHelper.setFieldHasBeenModified(t,!1),a.fields[t].bindableWrapper.pristine=!0),a.formForStateHelper.setFieldError(t,null)},s.resetErrors=function(){for(var e in a.fields)a.formForStateHelper.getFieldError(e)&&(a.formForStateHelper.setFieldHasBeenModified(e,!1),a.fields[e].bindableWrapper.pristine=!0);a.formForStateHelper.setFormSubmitted(!1),a.formForStateHelper.resetFieldErrors()},s.resetFields=s.resetErrors,s.validateField=function(e){{var t=l.flattenAttribute(e);a.fields[t],i(e)(a.formFor)}a.formForStateHelper.setFieldHasBeenModified(t,!0),a.$validationRules&&u.validateField(a.formFor,e,a.$validationRules).then(function(){a.formForStateHelper.setFieldError(t,null)},function(e){a.formForStateHelper.setFieldError(t,e)})},s.validateForm=function(){a.updateCollectionErrors({}),a.updateFieldErrors({});var e,t;if(a.$validationRules){var i=[];angular.forEach(a.fields,function(e){i.push(e.fieldName)}),t=u.validateFields(a.formFor,i,a.$validationRules),t.then(angular.noop,a.updateFieldErrors),i=[],angular.forEach(a.collectionLabels,function(e,t){i.push(t)}),e=u.validateFields(a.formFor,i,a.$validationRules),e.then(angular.noop,a.updateCollectionErrors)}else e=r.resolve(),t=r.resolve();var o=r.defer();return r.waitForAll([e,t]).then(o.resolve,function(e){angular.isArray(e[0])&&0===e[0].length&&e.splice(0,1),o.reject(e)}),o.promise},a.controller=a.controller||{},angular.copy(s,a.controller),a.$watch("disable",function(e){angular.forEach(a.fields,function(t){t.bindableWrapper.disabled=e}),angular.forEach(a.buttons,function(t){t.disabled=e})}),a.formForStateHelper=new n(a),a.$watch("formForStateHelper.watchable",function(){var e=a.formForStateHelper.hasFormBeenSubmitted();angular.forEach(a.fields,function(t,i){if(e||a.formForStateHelper.hasFieldBeenModified(i)){var r=a.formForStateHelper.getFieldError(i);t.bindableWrapper.error=r?o.trustAsHtml(r):null}else t.bindableWrapper.error=null}),angular.forEach(a.collectionLabels,function(e,t){var i=a.formForStateHelper.getFieldError(t);e.error=i?o.trustAsHtml(i):null})}),a.updateCollectionErrors=function(e){angular.forEach(a.collectionLabels,function(t,i){var r=l.readAttribute(e,i);a.formForStateHelper.setFieldError(i,r)})},a.updateFieldErrors=function(e){angular.forEach(a.fields,function(t,i){var r=l.readAttribute(e,t.fieldName);a.formForStateHelper.setFieldError(i,r)})}}],link:function(e,t,i){t.on("submit",function(){return e.formForStateHelper.setFormSubmitted(!0),e.disable=!0,e.controller.validateForm().then(function(){var t;t=i.submitWith?e.submitWith({data:e.formFor}):e.$service&&e.$service.submit?e.$service.submit(e.formFor):r.reject("No submit function provided"),t||(t=r.reject("Submit function did not return a promise")),t.then(function(t){i.submitComplete?e.submitComplete({data:t}):a.defaultSubmitComplete(t)},function(t){angular.isObject(t)&&(e.updateCollectionErrors(t),e.updateFieldErrors(t)),i.submitError?e.submitError({error:t}):a.defaultSubmitError(t)}),t["finally"](function(){e.disable=!1})},function(){e.disable=!1,i.validationFailed?e.validationFailed():a.defaultValidationFailed()}),!1})}}}]),angular.module("formFor").directive("radioField",["$log","FieldHelper",function(e,t){var i={};return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/radio-field.html",scope:{attribute:"@",disable:"=",help:"@?",value:"@"},link:function(r,o,a,n){if(!r.attribute)return void e.error('Missing required field "attribute"');if(!i[r.attribute]){var l={defaultScope:r,scopes:[]};t.manageFieldRegistration(r,n),i[r.attribute]=l}var u=i[r.attribute];u.scopes.push(r),r.label=t.getLabel(a,r.value),r.tabIndex=a.tabIndex||0;o.find("input");r.click=function(){r.disable||r.model.disabled||(r.model.bindable=r.value)},u.defaultScope.$watch("model",function(e){r.model=e}),u.defaultScope.$watch("disable",function(e){r.disable=e}),u.defaultScope.$watch("model.disabled",function(e){r.model&&(r.model.disabled=e)}),r.$watch("model.bindable",function(e){r.checked=void 0!==e&&null!==e&&void 0!==r.value&&null!==r.value&&e.toString()===r.value.toString()}),r.$on("$destroy",function(){u.scopes.splice(u.scopes.indexOf(r),1),0===u.scopes.length&&delete i[r.attribute]})}}}]),angular.module("formFor").directive("selectField",["$document","$log","$timeout","$window","FieldHelper",function(e,t,i,r,o){var a=250,n=10;return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/select-field.html",scope:{attribute:"@",disable:"=",filter:"=?",filterDebounce:"@?",help:"@?",options:"="},link:function(l,u,s,d){if(r=$(r),!l.attribute)return void t.error('Missing required field "attribute"');l.allowBlank=s.hasOwnProperty("allowBlank"),l.enableFiltering=s.hasOwnProperty("enableFiltering"),l.preventDefaultOption=s.hasOwnProperty("preventDefaultOption"),l.labelAttribute=s.labelAttribute||"label",l.valueAttribute=s.valueAttribute||"value",l.placeholder=s.placeholder||"Select",l.tabIndex=s.tabIndex||0,l.label=o.getLabel(s,l.attribute),o.manageFieldRegistration(l,d),l.emptyOption={},l.emptyOption[l.labelAttribute]="",l.emptyOption[l.valueAttribute]=null,l.filteredOptions=[];var c=function(e){return e&&e.toLowerCase()},f=function(){var e=l.options||[];if(l.filteredOptions.splice(0),l.enableFiltering&&l.filter){var t=c(l.filter);angular.forEach(e,function(e){var i=c(e[l.labelAttribute]).indexOf(t);i>=0&&l.filteredOptions.push(e)})}else angular.copy(e,l.filteredOptions);l.allowBlank&&l.filteredOptions.unshift(l.emptyOption)};l.$watch("filter",f),l.$watch("options.length",f);var p=function(){var e=l.selectedOption&&l.selectedOption[[l.valueAttribute]];return l.model.bindable===e?void(!l.allowBlank&&!l.preventDefaultOption&&l.options&&l.options.length&&(l.model.bindable=l.options[0][l.valueAttribute])):void 0};l.$watch("model.bindable",p),l.$watch("options.length",p);var m=u.find(".select-field-toggle-button");l.close=function(){i(function(){l.isOpen=!1},n)},l.open=function(){i(function(){l.isOpen=!0},n)},l.$watch("model.bindable",function(){var e;angular.forEach(l.options,function(t){t[l.valueAttribute]===l.model.bindable&&(e=t)}),l.selectedOption=e,l.selectedOptionLabel=e&&e[l.labelAttribute],l.filter=l.selectedOptionLabel}),l.selectOption=function(e){l.model.bindable=e&&e[l.valueAttribute],l.isOpen=!1};var b=function(){l.isOpen=!1,l.$apply()},F=u.find(".list-group-container"),g=u.find(".list-group-scrollable"),v=(u.find(".list-group"),function(e){i(function(){for(var t,i=this.find(".list-group-item"),r=0;r<i.length;r++){var o=i[r],a=$(o).scope().option;if(a&&a[l.valueAttribute]===e){t=o;break}}if(t){g.scrollTop(0);var n=g.scrollTop(),u=g.outerHeight(),s=$(t).position().top,d=$(t).outerHeight();0===u?g.scrollTop(s):n>s?g.scrollTop(s):s+d>n+u&&g.scrollTop(s-u+d)}}.bind(u),n)}),h=function(){l.disable||l.model.disabled||(l.isOpen=!0,l.isOpen&&(M(),v(l.model.bindable)),l.$$phase||l.$digest())};l.$watch("isOpen",function(){i(function(){l.isOpen?(m.off("click",h),e.on("click",b)):(m.on("click",h),e.off("click",b))},n)});var O=function(){switch(s.direction){case"up":return!0;case"down":return!1;case"auto":default:var e=m.offset().top-r.scrollTop();return e+m.outerHeight()+a>r.height()}},M=function(){O()?(l.dropUp=!0,F.css({bottom:m.outerHeight()-1+"px",top:"auto"})):(l.dropUp=!1,F.css({bottom:"auto",top:"100%"}))},y=u.find(".filter-text-input");l.mouseOver=function(e){l.mouseOverIndex=e,l.mouseOverOption=e>=0?l.filteredOptions[e]:null},l.keyDown=function(e){switch(e.keyCode){case 27:l.isOpen=!1,i(m.focus.bind(m));break;case 13:l.isOpen?(l.selectOption(l.mouseOverOption),l.isOpen=!1,i(m.focus.bind(m))):(l.isOpen=!0,M()),e.preventDefault();break;case 38:l.mouseOver(l.mouseOverIndex>0?l.mouseOverIndex-1:l.filteredOptions.length-1),v(l.mouseOverOption&&l.mouseOverOption.value),e.preventDefault();break;case 40:l.mouseOver(l.mouseOverIndex<l.filteredOptions.length-1?l.mouseOverIndex+1:0),v(l.mouseOverOption&&l.mouseOverOption.value),e.preventDefault();break;case 9:case 16:l.isOpen=!1;break;default:l.isOpen=!0}},l.$watchCollection("[isOpen, filteredOptions.length]",function(){l.mouseOver(-1),l.isOpen&&l.enableFiltering&&i(y.focus.bind(y))}),l.$on("$destroy",function(){e.off("click",b)})}}}]),angular.module("formFor").directive("submitButton",["$log","$sce",function(e,t){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/submit-button.html",scope:{disable:"=",icon:"@",label:"@"},link:function(e,i,r,o){e.buttonClass=r.buttonClass,e.tabIndex=r.tabIndex||0,e.$watch("label",function(i){e.bindableLabel=t.trustAsHtml(i)}),e.model=o.registerSubmitButton(e)}}}]),angular.module("formFor").directive("textField",["$log","$timeout","FieldHelper",function(e,t,i){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/text-field.html",scope:{attribute:"@",debounce:"@?",disable:"=",focused:"&?",help:"@?",iconAfterClicked:"&?",iconBeforeClicked:"&?",placeholder:"@?"},link:function(r,o,a,n){if(!r.attribute)return void e.error('Missing required field "attribute"');if(r.label=i.getLabel(a,r.attribute),r.type=a.type||"text",r.multiline=a.hasOwnProperty("multiline")&&"false"!==a.multiline,r.tabIndex=a.tabIndex||0,a.hasOwnProperty("autofocus")&&t(function(){o.find(r.multiline?"textarea":"input").focus()}),i.manageFieldRegistration(r,n),a.iconAfter){var l=function(){if(r.model){var e="{"===a.iconAfter.charAt(0)?r.$eval(a.iconAfter):a.iconAfter;r.iconAfter=angular.isObject(e)?r.model.error?e.invalid:r.model.pristine?e.pristine:e.valid:e}};a.$observe("iconAfter",l),r.$watch("model.error",l),r.$watch("model.pristine",l)}if(a.iconBefore){var u=function(){if(r.model){var e="{"===a.iconBefore.charAt(0)?r.$eval(a.iconBefore):a.iconBefore;r.iconBefore=angular.isObject(e)?r.model.error?e.invalid:r.model.pristine?e.pristine:e.valid:e}};a.$observe("iconBefore",u),r.$watch("model.error",u),r.$watch("model.pristine",u)}r.onIconAfterClick=function(){a.hasOwnProperty("iconAfterClicked")&&r.iconAfterClicked()},r.onIconBeforeClick=function(){a.hasOwnProperty("iconBeforeClicked")&&r.iconBeforeClicked()},r.onFocus=function(){a.hasOwnProperty("focused")&&r.focused()}}}}]),angular.module("formFor").service("FieldHelper",["FormForConfiguration","StringUtil",function(e,t){this.getLabel=function(i,r){return i.hasOwnProperty("label")?i.label:e.autoGenerateLabels?t.humanize(r):void 0},this.manageFieldRegistration=function(e,t){e.$watch("attribute",function(i,r){e.model&&t.unregisterFormField(r),e.model=t.registerFormField(e.attribute)}),e.$on("$destroy",function(){t.unregisterFormField(e.attribute)})}}]),angular.module("formFor").service("FormForConfiguration",function(){return{autoGenerateLabels:!1,defaultDebounceDuration:1e3,defaultSubmitComplete:angular.noop,defaultSubmitError:angular.noop,defaultValidationFailed:angular.noop,requiredLabel:null,validationFailedForCustomMessage:"Failed custom validation",validationFailedForPatternMessage:"Invalid format",validationFailedForMaxCollectionSizeMessage:"Must be fewer than {{num}} items",validationFailedForMaxLengthMessage:"Must be fewer than {{num}} characters",validationFailedForMinCollectionSizeMessage:"Must at least {{num}} items",validationFailedForMinLengthMessage:"Must be at least {{num}} characters",validationFailedForRequiredMessage:"Required field",validationFailedForEmailTypeMessage:"Invalid email format",validationFailedForIntegerTypeMessage:"Must be an integer",validationFailedForNegativeTypeMessage:"Must be negative",validationFailedForNumericTypeMessage:"Must be numeric",validationFailedForPositiveTypeMessage:"Must be positive",disableAutoLabels:function(){this.autoGenerateLabels=!1},enableAutoLabels:function(){this.autoGenerateLabels=!0},setDefaultDebounceDuration:function(e){this.defaultDebounceDuration=e},setDefaultSubmitComplete:function(e){this.defaultSubmitComplete=e},setDefaultSubmitError:function(e){this.defaultSubmitError=e},setDefaultValidationFailed:function(e){this.defaultValidationFailed=e},setRequiredLabel:function(e){this.requiredLabel=e},setValidationFailedForCustomMessage:function(e){this.validationFailedForCustomMessage=e},setValidationFailedForMaxCollectionSizeMessage:function(e){this.validationFailedForMaxCollectionSizeMessage=e},setValidationFailedForMaxLengthMessage:function(e){this.validationFailedForMaxLengthMessage=e},setValidationFailedForMinCollectionSizeMessage:function(e){this.validationFailedForMaxCollectionSizeMessage=e},setValidationFailedForMinLengthMessage:function(e){this.validationFailedForMinLengthMessage=e},setValidationFailedForPatternMessage:function(e){this.validationFailedForPatternMessage=e},setValidationFailedForRequiredMessage:function(e){this.validationFailedForRequiredMessage=e},setValidationFailedForEmailTypeMessage:function(e){this.validationFailedForEmailTypeMessage=e},setValidationFailedForIntegerTypeMessage:function(e){this.validationFailedForIntegerTypeMessage=e},setValidationFailedForNegativeTypeMessage:function(e){this.validationFailedForNegativeTypeMessage=e},setValidationFailedForNumericTypeMessage:function(e){this.validationFailedForNumericTypeMessage=e},setValidationFailedForPositiveTypeMessage:function(e){this.validationFailedForPositiveTypeMessage=e}}}),angular.module("formFor").factory("$FormForStateHelper",["NestedObjectHelper",function(e){var t=function(e){e.errorMap=e.errorMap||{},e.valid=!0,this.formScope=e,this.fieldNameToModificationMap={},this.formSubmitted=!1,this.shallowErrorMap={},this.watchable=0};return t.prototype.getFieldError=function(t){return e.readAttribute(this.formScope.errorMap,t)},t.prototype.hasFieldBeenModified=function(t){return e.readAttribute(this.fieldNameToModificationMap,t)},t.prototype.hasFormBeenSubmitted=function(){return this.formSubmitted},t.prototype.isFieldValid=function(e){return!getFieldError(e)},t.prototype.isFormInvalid=function(){return!this.isFormValid()},t.prototype.isFormValid=function(){for(var e in this.shallowErrorMap)return!1;return!0},t.prototype.resetFieldErrors=function(){this.formScope.errorMap={}},t.prototype.setFieldError=function(t,i){var r=e.flattenAttribute(t);e.writeAttribute(this.formScope.errorMap,t,i),i?this.shallowErrorMap[r]=i:delete this.shallowErrorMap[r],this.formScope.valid=this.isFormValid(),this.watchable++},t.prototype.setFieldHasBeenModified=function(t,i){e.writeAttribute(this.fieldNameToModificationMap,t,i),this.watchable++},t.prototype.setFormSubmitted=function(e){this.formSubmitted=e,this.watchable++},t}]),angular.module("formFor").service("ModelValidator",["$interpolate","$q","FormForConfiguration","NestedObjectHelper",function(e,t,i,r){return this.$getRulesForFieldName=function(e,t){return t=t.replace(/\[[^\]]+\]/g,".collection.fields"),r.readAttribute(e,t)},this.isCollectionRequired=function(e,t){var i=this.$getRulesForFieldName(t,e);return i&&i.collection&&i.collection.min&&(angular.isObject(i.collection.min)?i.collection.min.rule:i.collection.min)},this.isFieldRequired=function(e,t){var i=this.$getRulesForFieldName(t,e);return i&&i.required&&(angular.isObject(i.required)?i.required.rule:i.required)},this.validateAll=function(e,t){var i=r.flattenObjectKeys(t);return this.validateFields(e,i,t)},this.validateFields=function(e,i,o){var a=t.defer(),n=[],l={};return angular.forEach(i,function(t){var i=this.$getRulesForFieldName(o,t);if(i){var a;a=i.collection?this.validateCollection(e,t,o):this.validateField(e,t,o),a.then(angular.noop,function(e){r.writeAttribute(l,t,e)}),n.push(a)}},this),t.waitForAll(n).then(a.resolve,function(){a.reject(l)}),a.promise},this.validateCollection=function(o,a,n){var l=this.$getRulesForFieldName(n,a),u=r.readAttribute(o,a);if(l&&l.collection){u=u||[];var s=l.collection;if(s.min){var d=angular.isObject(s.min)?s.min.rule:s.min;if(u.length<d)return t.reject(angular.isObject(s.min)?s.min.message:e(i.validationFailedForMinCollectionSizeMessage)({num:d}))}if(s.max){var c=angular.isObject(s.max)?s.max.rule:s.max;if(u.length>c)return t.reject(angular.isObject(s.max)?s.max.message:e(i.validationFailedForMaxCollectionSizeMessage)({num:c}))}}return t.resolve()},this.validateField=function(o,a,n){var l=this.$getRulesForFieldName(n,a),u=r.readAttribute(o,a);if(l){if(u=u||"",l.required){var s=angular.isObject(l.required)?l.required.rule:l.required;if(!!u!==s)return t.reject(angular.isObject(l.required)?l.required.message:i.validationFailedForRequiredMessage)}if(l.minlength){var d=angular.isObject(l.minlength)?l.minlength.rule:l.minlength;if(u.length<d)return t.reject(angular.isObject(l.minlength)?l.minlength.message:e(i.validationFailedForMinLengthMessage)({num:d}))}if(l.maxlength){var c=angular.isObject(l.maxlength)?l.maxlength.rule:l.maxlength;if(u.length>c)return t.reject(angular.isObject(l.maxlength)?l.maxlength.message:e(i.validationFailedForMaxLengthMessage)({num:c}))}if(l.type){var f=angular.isObject(l.type)?l.type.rule:l.type,p=u.toString();if(f.indexOf("integer")>=0&&!p.match(/^\-*[0-9]+$/))return t.reject(angular.isObject(l.type)?l.type.message:i.validationFailedForIntegerTypeMessage);if(f.indexOf("number")>=0&&!p.match(/^\-*[0-9\.]+$/))return t.reject(angular.isObject(l.type)?l.type.message:i.validationFailedForNumericTypeMessage);if(f.indexOf("negative")>=0&&!p.match(/^\-[0-9\.]+$/))return t.reject(angular.isObject(l.type)?l.type.message:i.validationFailedForNegativeTypeMessage);if(f.indexOf("positive")>=0&&!p.match(/^[0-9\.]+$/))return t.reject(angular.isObject(l.type)?l.type.message:i.validationFailedForPositiveTypeMessage);if(f.indexOf("email")>=0&&!p.match(/^[\w\.\+]+@\w+\.\w+$/))return t.reject(angular.isObject(l.type)?l.type.message:i.validationFailedForEmailTypeMessage)}if(l.pattern){var m=l.pattern instanceof RegExp,b=m?l.pattern:l.pattern.rule;if(!b.exec(u))return t.reject(m?i.validationFailedForPatternMessage:l.pattern.message)}if(l.custom){var F=angular.isFunction(l.custom)?i.validationFailedForCustomMessage:l.custom.message,g=angular.isFunction(l.custom)?l.custom:l.custom.rule;try{var v=g(u,o)}catch(h){return t.reject(h.message||F)}return angular.isObject(v)&&angular.isFunction(v.then)?v.then(function(e){return t.resolve(e)},function(e){return t.reject(e||F)}):v?t.resolve(v):t.reject(F)}}return t.resolve()},this}]),angular.module("formFor").service("NestedObjectHelper",["$parse",function(e){return{$createEmptyArrays:function(e,t){for(var i=0;;){if(i=t.indexOf("[",i),0>i)break;var r=t.substr(0,i),o=this.readAttribute(e,r);o||(o=[],this.writeAttribute(e,r,o));var a=t.substr(i).match(/([0-9]+)\]\./);if(a){var n=parseInt(a[1]);o[n]||(o[n]={})}i++}},flattenAttribute:function(e){return e=e.replace(/\[([^\]]+)\]\.{0,1}/g,"___$1___"),e=e.replace(/\./g,"___")},flattenObjectKeys:function(e){for(var t=[],i=[{object:e,prefix:null}];;){if(0===i.length)break;var r=i.pop(),o=r.prefix?r.prefix+".":"";if("object"==typeof r.object)for(var a in r.object){var n=o+a;t.push(n),i.push({object:r.object[a],prefix:n})}}return t},readAttribute:function(t,i){return e(i)(t)},writeAttribute:function(t,i,r){this.$createEmptyArrays(t,i),e(i).assign(t,r)}}}]);var qDecorator=["$delegate",function(e){return e.resolve=function(e){var t=this.defer();return t.resolve(e),t.promise},e.waitForAll=function(e){var t=this.defer(),i=[],r=0,o=!1,a=function(e,t){i.hasOwnProperty(e)||(i[e]=t,r--),n()},n=function(){0===r&&(o?t.reject(i):t.resolve(i))};return angular.forEach(e,function(e,t){r++,e.then(function(e){a(t,e)},function(e){o=!0,a(t,e)})}),n(),t.promise},e}];angular.module("formFor").config(["$provide",function(e){e.decorator("$q",qDecorator)}]),angular.module("formFor").service("StringUtil",function(){this.humanize=function(e){return e?(e=e.replace(/[A-Z]/g,function(e){return" "+e}),e=e.replace(/_([a-z])/g,function(e,t){return" "+t.toUpperCase()}),e=e.replace(/\s+/g," "),e=e.trim(),e=e.charAt(0).toUpperCase()+e.slice(1)):""}});